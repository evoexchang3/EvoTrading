<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Risk Management Matrix</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 40px auto; padding: 20px; line-height: 1.6; background: #f8f9fa; }
        h1 { color: #0891b2; border-bottom: 3px solid #0891b2; padding-bottom: 10px; }
        h2 { color: #0e7490; margin-top: 30px; background: #ecfeff; padding: 12px; border-left: 4px solid #0891b2; }
        .container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #0891b2; color: white; padding: 12px; text-align: left; font-weight: bold; }
        td { border: 1px solid #ddd; padding: 10px; }
        tr:nth-child(even) { background: #f9fafb; }
        input[type="number"], input[type="text"], select { width: 100%; padding: 8px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px; }
        input[type="number"]:focus, select:focus { border-color: #0891b2; outline: none; }
        .calc-section { margin: 25px 0; padding: 20px; background: #f0fdfa; border-left: 4px solid #0891b2; border-radius: 4px; }
        .result-box { background: #dcfce7; border: 2px solid #16a34a; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .warning-box { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 15px 0; }
        .danger-box { background: #fee2e2; border-left: 4px solid #dc2626; padding: 15px; margin: 15px 0; }
        .info-box { background: #dbeafe; border-left: 4px solid #3b82f6; padding: 15px; margin: 15px 0; }
        button { background: #0891b2; color: white; padding: 12px 24px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; margin: 5px; }
        button:hover { background: #0e7490; }
        .matrix-cell { text-align: center; font-weight: bold; padding: 15px !important; }
        .risk-low { background: #dcfce7 !important; color: #166534; }
        .risk-medium { background: #fef3c7 !important; color: #92400e; }
        .risk-high { background: #fee2e2 !important; color: #991b1b; }
        @media print { body { margin: 15px; background: white; } .no-print { display: none; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>Advanced Risk Management Matrix</h1>
        
        <div class="info-box no-print">
            <strong>Purpose:</strong> This comprehensive risk management tool helps you calculate position sizes, manage portfolio risk, and make data-driven trading decisions.
        </div>

        <!-- Portfolio Overview -->
        <div class="calc-section">
            <h2>1. Portfolio Risk Overview</h2>
            <table>
                <tr>
                    <td style="width: 50%;"><strong>Total Account Balance ($):</strong></td>
                    <td><input type="number" id="accountBalance" value="10000"></td>
                </tr>
                <tr>
                    <td><strong>Maximum Risk Per Trade (%):</strong></td>
                    <td><input type="number" id="maxRiskPerTrade" value="2" step="0.1"></td>
                </tr>
                <tr>
                    <td><strong>Maximum Total Portfolio Risk (%):</strong></td>
                    <td><input type="number" id="maxPortfolioRisk" value="6" step="0.5"></td>
                </tr>
                <tr>
                    <td><strong>Current Open Positions:</strong></td>
                    <td><input type="number" id="openPositions" value="0"></td>
                </tr>
                <tr>
                    <td><strong>Current Portfolio Risk (%):</strong></td>
                    <td><input type="number" id="currentRisk" value="0" step="0.1"></td>
                </tr>
            </table>
            <button onclick="calculatePortfolioMetrics()">Calculate Portfolio Metrics</button>
            
            <div id="portfolioResult" class="result-box" style="display: none;">
                <h3>Portfolio Status</h3>
                <div id="portfolioDetails"></div>
            </div>
        </div>

        <!-- Position Sizing Matrix -->
        <div class="calc-section">
            <h2>2. Multi-Position Sizing Matrix</h2>
            <div class="info-box">
                Manage multiple positions with different risk levels based on trade quality.
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Trade Quality</th>
                        <th>Setup Rating</th>
                        <th>Risk Per Trade</th>
                        <th>Max Positions</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>A+ (Perfect)</td>
                        <td>5 stars</td>
                        <td><input type="number" value="2.0" step="0.1">%</td>
                        <td><input type="number" value="3"></td>
                        <td><input type="text" placeholder="All criteria met"></td>
                    </tr>
                    <tr>
                        <td>A (Strong)</td>
                        <td>4 stars</td>
                        <td><input type="number" value="1.5" step="0.1">%</td>
                        <td><input type="number" value="2"></td>
                        <td><input type="text" placeholder="Most criteria met"></td>
                    </tr>
                    <tr>
                        <td>B (Good)</td>
                        <td>3 stars</td>
                        <td><input type="number" value="1.0" step="0.1">%</td>
                        <td><input type="number" value="2"></td>
                        <td><input type="text" placeholder="Decent setup"></td>
                    </tr>
                    <tr>
                        <td>C (Marginal)</td>
                        <td>2 stars</td>
                        <td><input type="number" value="0.5" step="0.1">%</td>
                        <td><input type="number" value="1"></td>
                        <td><input type="text" placeholder="Skip or minimal risk"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Correlation Matrix -->
        <div class="calc-section">
            <h2>3. Correlation Risk Matrix</h2>
            <div class="warning-box">
                <strong>Important:</strong> Avoid highly correlated positions to prevent concentrated risk.
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Pair/Asset</th>
                        <th>EUR/USD</th>
                        <th>GBP/USD</th>
                        <th>USD/JPY</th>
                        <th>Gold</th>
                        <th>BTC/USD</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>EUR/USD</strong></td>
                        <td class="matrix-cell">1.00</td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.85</td>
                        <td class="matrix-cell" style="background: #fee2e2;">-0.75</td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.60</td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.15</td>
                    </tr>
                    <tr>
                        <td><strong>GBP/USD</strong></td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.85</td>
                        <td class="matrix-cell">1.00</td>
                        <td class="matrix-cell" style="background: #fef3c7;">-0.65</td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.55</td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.20</td>
                    </tr>
                    <tr>
                        <td><strong>USD/JPY</strong></td>
                        <td class="matrix-cell" style="background: #fee2e2;">-0.75</td>
                        <td class="matrix-cell" style="background: #fef3c7;">-0.65</td>
                        <td class="matrix-cell">1.00</td>
                        <td class="matrix-cell" style="background: #fef3c7;">-0.50</td>
                        <td class="matrix-cell" style="background: #dcfce7;">-0.10</td>
                    </tr>
                    <tr>
                        <td><strong>Gold</strong></td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.60</td>
                        <td class="matrix-cell" style="background: #fef3c7;">0.55</td>
                        <td class="matrix-cell" style="background: #fef3c7;">-0.50</td>
                        <td class="matrix-cell">1.00</td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.35</td>
                    </tr>
                    <tr>
                        <td><strong>BTC/USD</strong></td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.15</td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.20</td>
                        <td class="matrix-cell" style="background: #dcfce7;">-0.10</td>
                        <td class="matrix-cell" style="background: #dcfce7;">0.35</td>
                        <td class="matrix-cell">1.00</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>Correlation Guide:</strong>
                <ul style="margin: 10px 0; padding-left: 25px;">
                    <li><span style="background: #dcfce7; padding: 3px 8px; border-radius: 4px;"><strong>0 to Â±0.3:</strong> Low correlation - Safe to hold together</span></li>
                    <li><span style="background: #fef3c7; padding: 3px 8px; border-radius: 4px;"><strong>Â±0.3 to Â±0.7:</strong> Medium correlation - Limit exposure</span></li>
                    <li><span style="background: #fee2e2; padding: 3px 8px; border-radius: 4px;"><strong>Â±0.7 to Â±1.0:</strong> High correlation - Avoid simultaneous positions</span></li>
                </ul>
            </div>
        </div>

        <!-- Volatility Adjustment -->
        <div class="calc-section">
            <h2>4. Volatility-Adjusted Position Sizing</h2>
            <div class="info-box">
                Adjust position size based on market volatility (ATR-based approach).
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Asset</th>
                        <th>Current ATR</th>
                        <th>Average ATR (20)</th>
                        <th>Volatility Ratio</th>
                        <th>Position Size Adjustment</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="e.g., EUR/USD"></td>
                        <td><input type="number" step="0.0001" placeholder="e.g., 0.0085"></td>
                        <td><input type="number" step="0.0001" placeholder="e.g., 0.0070"></td>
                        <td id="volRatio1">-</td>
                        <td id="adjustment1">-</td>
                    </tr>
                    <tr>
                        <td><input type="text" placeholder="e.g., Gold"></td>
                        <td><input type="number" step="0.01" placeholder="e.g., 25.50"></td>
                        <td><input type="number" step="0.01" placeholder="e.g., 20.00"></td>
                        <td id="volRatio2">-</td>
                        <td id="adjustment2">-</td>
                    </tr>
                </tbody>
            </table>
            <button onclick="calculateVolatility()">Calculate Volatility Adjustments</button>
        </div>

        <!-- Drawdown Recovery Calculator -->
        <div class="calc-section">
            <h2>5. Drawdown Recovery Matrix</h2>
            <table>
                <thead>
                    <tr>
                        <th>Drawdown %</th>
                        <th>Remaining Capital</th>
                        <th>Gain Needed to Recover</th>
                        <th>Time to Recover (est.)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>5%</td>
                        <td>95%</td>
                        <td class="matrix-cell risk-low">5.3%</td>
                        <td>~1-2 months</td>
                    </tr>
                    <tr>
                        <td>10%</td>
                        <td>90%</td>
                        <td class="matrix-cell risk-low">11.1%</td>
                        <td>~2-3 months</td>
                    </tr>
                    <tr>
                        <td>15%</td>
                        <td>85%</td>
                        <td class="matrix-cell risk-medium">17.6%</td>
                        <td>~3-4 months</td>
                    </tr>
                    <tr>
                        <td>20%</td>
                        <td>80%</td>
                        <td class="matrix-cell risk-medium">25.0%</td>
                        <td>~4-6 months</td>
                    </tr>
                    <tr>
                        <td>25%</td>
                        <td>75%</td>
                        <td class="matrix-cell risk-high">33.3%</td>
                        <td>~6-8 months</td>
                    </tr>
                    <tr>
                        <td>30%</td>
                        <td>70%</td>
                        <td class="matrix-cell risk-high">42.9%</td>
                        <td>~8-12 months</td>
                    </tr>
                    <tr>
                        <td>50%</td>
                        <td>50%</td>
                        <td class="matrix-cell risk-high" style="background: #7f1d1d !important; color: white;">100%</td>
                        <td>>12 months</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="danger-box">
                <strong>Critical Lesson:</strong> A 50% drawdown requires a 100% gain to recover. This is why risk management is paramount. Never risk more than you can afford to lose!
            </div>
        </div>

        <!-- Risk Limits Tracker -->
        <div class="calc-section">
            <h2>6. Daily/Weekly Risk Limits</h2>
            <table>
                <thead>
                    <tr>
                        <th>Period</th>
                        <th>Max Loss Limit</th>
                        <th>Current Loss</th>
                        <th>Remaining Risk Budget</th>
                        <th>Action Required</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Today</td>
                        <td><input type="text" id="dailyLimit" placeholder="e.g., 3%"></td>
                        <td><input type="text" id="dailyLoss" placeholder="e.g., 1.5%"></td>
                        <td id="dailyRemaining">-</td>
                        <td id="dailyAction">-</td>
                    </tr>
                    <tr>
                        <td>This Week</td>
                        <td><input type="text" id="weeklyLimit" placeholder="e.g., 6%"></td>
                        <td><input type="text" id="weeklyLoss" placeholder="e.g., 2.5%"></td>
                        <td id="weeklyRemaining">-</td>
                        <td id="weeklyAction">-</td>
                    </tr>
                    <tr>
                        <td>This Month</td>
                        <td><input type="text" id="monthlyLimit" placeholder="e.g., 12%"></td>
                        <td><input type="text" id="monthlyLoss" placeholder="e.g., 5%"></td>
                        <td id="monthlyRemaining">-</td>
                        <td id="monthlyAction">-</td>
                    </tr>
                </tbody>
            </table>
            <button onclick="checkRiskLimits()">Check Risk Limits</button>
        </div>

        <div class="warning-box">
            <strong>ðŸ“Œ Risk Management Rules:</strong>
            <ul style="margin: 10px 0; padding-left: 25px;">
                <li>If daily loss limit hit: Stop trading immediately for 24 hours</li>
                <li>If weekly loss limit hit: Stop trading, review strategy, resume next week</li>
                <li>If monthly loss limit hit: Stop trading, conduct full performance review</li>
                <li>Never increase position size to "recover" losses (revenge trading)</li>
                <li>Scale up position sizes only after consistent profitability</li>
            </ul>
        </div>
    </div>

    <script>
        function calculatePortfolioMetrics() {
            const balance = parseFloat(document.getElementById('accountBalance').value) || 0;
            const maxPerTrade = parseFloat(document.getElementById('maxRiskPerTrade').value) || 0;
            const maxPortfolio = parseFloat(document.getElementById('maxPortfolioRisk').value) || 0;
            const currentRisk = parseFloat(document.getElementById('currentRisk').value) || 0;

            const remainingRisk = maxPortfolio - currentRisk;
            const canTakeNewTrade = remainingRisk >= maxPerTrade;
            const maxNewTrades = Math.floor(remainingRisk / maxPerTrade);

            let statusHtml = `
                <p><strong>Account Balance:</strong> $${balance.toFixed(2)}</p>
                <p><strong>Max Risk Per Trade:</strong> $${(balance * maxPerTrade / 100).toFixed(2)} (${maxPerTrade}%)</p>
                <p><strong>Current Portfolio Risk:</strong> ${currentRisk}%</p>
                <p><strong>Remaining Risk Budget:</strong> ${remainingRisk.toFixed(2)}%</p>
            `;

            if (canTakeNewTrade) {
                statusHtml += `<p style="color: #16a34a;"><strong>Status:</strong> Can take up to ${maxNewTrades} new trade(s)</p>`;
            } else {
                statusHtml += `<p style="color: #dc2626;"><strong>Status:</strong> Portfolio risk limit reached. Cannot take new trades.</p>`;
            }

            document.getElementById('portfolioResult').style.display = 'block';
            document.getElementById('portfolioDetails').innerHTML = statusHtml;
        }

        function calculateVolatility() {
            alert('Volatility adjustment calculations would be performed here based on ATR values.');
        }

        function checkRiskLimits() {
            const parsePercent = (val) => parseFloat(val.replace('%', '')) || 0;
            
            const dailyLimit = parsePercent(document.getElementById('dailyLimit').value);
            const dailyLoss = parsePercent(document.getElementById('dailyLoss').value);
            const dailyRemaining = dailyLimit - dailyLoss;
            
            document.getElementById('dailyRemaining').textContent = dailyRemaining.toFixed(2) + '%';
            document.getElementById('dailyAction').innerHTML = dailyLoss >= dailyLimit ? 
                '<span style="color: #dc2626; font-weight: bold;">STOP TRADING TODAY</span>' : 
                '<span style="color: #16a34a;">OK to continue</span>';

            const weeklyLimit = parsePercent(document.getElementById('weeklyLimit').value);
            const weeklyLoss = parsePercent(document.getElementById('weeklyLoss').value);
            const weeklyRemaining = weeklyLimit - weeklyLoss;
            
            document.getElementById('weeklyRemaining').textContent = weeklyRemaining.toFixed(2) + '%';
            document.getElementById('weeklyAction').innerHTML = weeklyLoss >= weeklyLimit ? 
                '<span style="color: #dc2626; font-weight: bold;">STOP TRADING THIS WEEK</span>' : 
                '<span style="color: #16a34a;">OK to continue</span>';

            const monthlyLimit = parsePercent(document.getElementById('monthlyLimit').value);
            const monthlyLoss = parsePercent(document.getElementById('monthlyLoss').value);
            const monthlyRemaining = monthlyLimit - monthlyLoss;
            
            document.getElementById('monthlyRemaining').textContent = monthlyRemaining.toFixed(2) + '%';
            document.getElementById('monthlyAction').innerHTML = monthlyLoss >= monthlyLimit ? 
                '<span style="color: #dc2626; font-weight: bold;">STOP TRADING THIS MONTH</span>' : 
                '<span style="color: #16a34a;">OK to continue</span>';
        }
    </script>
</body>
</html>
